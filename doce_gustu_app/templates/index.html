{% extends "base.html" %}

{% block miolo %}
<main class="container my-5">
    <h2 class="text-center mb-4">Nossos Destaques</h2>
    
    <div id="carouselDestaque-desktop" class="carousel slide d-none d-md-block" data-bs-ride="carousel" data-bs-interval="5000">
        <div class="carousel-inner">
            {% if produtos_destaque|length >= 3 %}
                
                <div class="carousel-item active">
                    <div class="row justify-content-center align-items-center">
                        <div class="col-md-4 carousel-side-item text-center">
                            <div class="img-quadrada rounded">
                                <img src="{{ produtos_destaque.2.imagem_url }}" class="img-fluid" alt="{{ produtos_destaque.2.nome }}">
                            </div>
                            <h6 class="mt-2">{{ produtos_destaque.2.nome }}</h6>
                        </div>
                        <div class="col-md-4 carousel-center-item text-center">
                            <div class="img-quadrada rounded shadow">
                                <img src="{{ produtos_destaque.0.imagem_url }}" class="img-fluid" alt="{{ produtos_destaque.0.nome }}">
                            </div>
                            <div class="mt-3">
                                <h4>{{ produtos_destaque.0.nome }}</h4>
                                <p class="text-muted">{{ produtos_destaque.0.descricao|truncatewords:15 }}</p>
                                <h5 class="text-success">R$ {{ produtos_destaque.0.preco }}</h5>
                                <a href="{% url 'doce_gustu_app:produto' produtos_destaque.0.id %}" class="btn btn-primary btn-lg mt-2">Comprar</a>
                            </div>
                        </div>
                        <div class="col-md-4 carousel-side-item text-center">
                            <div class="img-quadrada rounded">
                                <img src="{{ produtos_destaque.1.imagem_url }}" class="img-fluid" alt="{{ produtos_destaque.1.nome }}">
                            </div>
                            <h6 class="mt-2">{{ produtos_destaque.1.nome }}</h6>
                        </div>
                    </div>
                </div>

                <div class="carousel-item">
                    <div class="row justify-content-center align-items-center">
                        <div class="col-md-4 carousel-side-item text-center">
                            <div class="img-quadrada rounded">
                                <img src="{{ produtos_destaque.0.imagem_url }}" class="img-fluid" alt="{{ produtos_destaque.0.nome }}">
                            </div>
                            <h6 class="mt-2">{{ produtos_destaque.0.nome }}</h6>
                        </div>
                        <div class="col-md-4 carousel-center-item text-center">
                            <div class="img-quadrada rounded shadow">
                                <img src="{{ produtos_destaque.1.imagem_url }}" class="img-fluid" alt="{{ produtos_destaque.1.nome }}">
                            </div>
                            <div class="mt-3">
                                <h4>{{ produtos_destaque.1.nome }}</h4>
                                <p class="text-muted">{{ produtos_destaque.1.descricao|truncatewords:15 }}</p>
                                <h5 class="text-success">R$ {{ produtos_destaque.1.preco }}</h5>
                                <a href="{% url 'doce_gustu_app:produto' produtos_destaque.1.id %}" class="btn btn-primary btn-lg mt-2">Comprar</a>
                            </div>
                        </div>
                        <div class="col-md-4 carousel-side-item text-center">
                            <div class="img-quadrada rounded">
                                <img src="{{ produtos_destaque.2.imagem_url }}" class="img-fluid" alt="{{ produtos_destaque.2.nome }}">
                            </div>
                            <h6 class="mt-2">{{ produtos_destaque.2.nome }}</h6>
                        </div>
                    </div>
                </div>

                <div class="carousel-item">
                    <div class="row justify-content-center align-items-center">
                        <div class="col-md-4 carousel-side-item text-center">
                            <div class="img-quadrada rounded">
                                <img src="{{ produtos_destaque.1.imagem_url }}" class="img-fluid" alt="{{ produtos_destaque.1.nome }}">
                            </div>
                            <h6 class="mt-2">{{ produtos_destaque.1.nome }}</h6>
                        </div>
                        <div class="col-md-4 carousel-center-item text-center">
                            <div class="img-quadrada rounded shadow">
                                <img src="{{ produtos_destaque.2.imagem_url }}" class="img-fluid" alt="{{ produtos_destaque.2.nome }}">
                            </div>
                            <div class="mt-3">
                                <h4>{{ produtos_destaque.2.nome }}</h4>
                                <p class="text-muted">{{ produtos_destaque.2.descricao|truncatewords:15 }}</p>
                                <h5 class="text-success">R$ {{ produtos_destaque.2.preco }}</h5>
                                <a href="{% url 'doce_gustu_app:produto' produtos_destaque.2.id %}" class="btn btn-primary btn-lg mt-2">Comprar</a>
                            </div>
                        </div>
                        <div class="col-md-4 carousel-side-item text-center">
                            <div class="img-quadrada rounded">
                                <img src="{{ produtos_destaque.0.imagem_url }}" class="img-fluid" alt="{{ produtos_destaque.0.nome }}">
                            </div>
                            <h6 class="mt-2">{{ produtos_destaque.0.nome }}</h6>
                        </div>
                    </div>
                </div>

            {% endif %}
        </div>
        
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselDestaque-desktop" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Anterior</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselDestaque-desktop" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Próximo</span>
        </button>
    </div>

    <div id="carouselDestaque-mobile" class="carousel slide d-md-none" data-bs-ride="carousel" data-bs-interval="5000">
        <div class="carousel-inner">
            {% if produtos_destaque %}
                {% for produto in produtos_destaque %}
                    <div class="carousel-item {% if forloop.first %}active{% endif %}">
                        <div class="row justify-content-center">
                            <div class="col-12 text-center">
                                <div class="img-quadrada rounded shadow">
                                    <img src="{{ produto.imagem_url }}" class="img-fluid" alt="{{ produto.nome }}">
                                </div>
                                <div class="mt-3">
                                    <h4>{{ produto.nome }}</h4>
                                    <p class="text-muted">{{ produto.descricao|truncatewords:15 }}</p>
                                    <h5 class="text-success">R$ {{ produto.preco }}</h5>
                                    <a href="{% url 'doce_gustu_app:produto' produto.id %}" class="btn btn-primary btn-lg mt-2">Comprar</a>
                                </div>
                            </div>
                        </div>
                    </div>
                {% endfor %}
            {% endif %}
        </div>
        
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselDestaque-mobile" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Anterior</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselDestaque-mobile" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Próximo</span>
        </button>
    </div>

    {% if not produtos_destaque %}
    <div class="text-center">
        <p class="text-muted">Nenhum produto em destaque encontrado.</p>
        <p>Por favor, adicione produtos no painel de administração e marque a caixa "Destaque".</p>
    </div>
    {% endif %}

    <style>
        /* Estilos do carrossel para desktop, ocultos em telas pequenas */
        @media (min-width: 768px) {
            .carousel-side-item {
                opacity: 0.6;
                filter: blur(2px);
                transform: scale(0.9);
                transition: all 0.5s ease;
            }

            .carousel-center-item {
                transform: scale(1.1);
                z-index: 2;
                transition: all 0.5s ease;
            }

            .carousel-item {
                padding: 40px 0;
            }
        }
        /* Estilos específicos para mobile (opcionais, mas boas práticas) */
        .carousel-item img {
            max-height: 300px;
            width: auto;
        }
        .carousel-control-prev-icon, .carousel-control-next-icon {
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 50%;
            width: 3rem;
            height: 3rem;
        }
    </style>
</main>
{% endblock miolo %}